const code = [
  [
    {
      code: "function ",
      klass: "code-keys",
    },
    {
      code: "createAlekitopi",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "mood",
      klass: "code-var",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: " {",
      klass: "code-object",
    },
  ],
  [
    {
      code: "    const ",
      klass: "code-keys",
    },
    {
      code: "alekitopi",
      klass: "code-var",
    },
    {
      code: " = ",
      klass: "code-white",
    },
    {
      code: "new ",
      klass: "code-keys",
    },
    {
      code: "Person",
      klass: "code-function",
    },
    {
      code: "()",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "setName",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: `"Alejandro Q."`,
      klass: "code-string",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "setBio",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: `"soy algo multiusos. se me ocurren ideas locas, programo y de vez en cuando hago directos"`,
      klass: "code-string",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "setNicks",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "[",
      klass: "code-object",
    },
    {
      code: `"alekitopi"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: `"aleki"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: `"ale"`,
      klass: "code-string",
    },

    {
      code: "]",
      klass: "code-object",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "setLocation",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: `"Canary Islands, Spain"`,
      klass: "code-string",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "setMood",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "mood",
      klass: "code-var",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [],
  [
    {
      code: "    /* working on... */",
      klass: "code-comment",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "addJob",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "{ ",
      klass: "code-object",
    },
    {
      code: "name",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"PyroNode"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "role",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"director"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "link",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"https://pyronode.com"`,
      klass: "code-string",
      link: true,
    },
    {
      code: " }",
      klass: "code-object",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "addJob",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "{ ",
      klass: "code-object",
    },
    {
      code: "name",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"TwitchUtilities"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "role",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"dev"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "link",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"https://twitter.com/twitchutilities"`,
      klass: "code-string",
      link: true,
    },
    {
      code: " }",
      klass: "code-object",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "addJob",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "{ ",
      klass: "code-object",
    },
    {
      code: "name",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"CanaryGames"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "role",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"owner"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "link",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"https://canarygames.net"`,
      klass: "code-string",
      link: true,
    },
    {
      code: " }",
      klass: "code-object",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "addJob",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "{ ",
      klass: "code-object",
    },
    {
      code: "name",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"InfamesRP"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "role",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"dev"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "link",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"https://infamesrp.com"`,
      klass: "code-string",
      link: true,
    },
    {
      code: " }",
      klass: "code-object",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [],
  [
    {
      code: "    /* social media */",
      klass: "code-comment",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "addSocial",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "{ ",
      klass: "code-object",
    },
    {
      code: "type",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"twitter"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "link",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"https://twitter.com/alekitopi"`,
      klass: "code-string",
      link: true,
    },
    {
      code: " }",
      klass: "code-object",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "addSocial",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "{ ",
      klass: "code-object",
    },
    {
      code: "type",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"twitch"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "link",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"https://twitch.tv/alekitopi"`,
      klass: "code-string",
      link: true,
    },
    {
      code: " }",
      klass: "code-object",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "addSocial",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "{ ",
      klass: "code-object",
    },
    {
      code: "type",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"discord"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "link",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"https://discord.gg/uDQnx5DnvU"`,
      klass: "code-string",
      link: true,
    },
    {
      code: " }",
      klass: "code-object",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "addSocial",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "{ ",
      klass: "code-object",
    },
    {
      code: "type",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"github"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "link",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"https://github.com/alekitopi"`,
      klass: "code-string",
      link: true,
    },
    {
      code: " }",
      klass: "code-object",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [],
  [
    {
      code: "    /* social media */",
      klass: "code-comment",
    },
  ],
  [
    {
      code: "    alekitopi",
      klass: "code-var",
    },
    {
      code: ".",
      klass: "code-white",
    },
    {
      code: "addHobbie",
      klass: "code-function",
    },
    {
      code: "(",
      klass: "code-bracket",
    },
    {
      code: "{ ",
      klass: "code-object",
    },
    {
      code: "thing",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"stream on twitch"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "where",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: "{ ",
      klass: "code-object",
    },
    {
      code: "type",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"platform"`,
      klass: "code-string",
    },
    {
      code: ", ",
      klass: "code-white",
    },
    {
      code: "arg",
      klass: "code-var",
    },
    {
      code: ": ",
      klass: "code-white",
    },
    {
      code: `"twitch"`,
      klass: "code-string",
    },
    {
      code: " }",
      klass: "code-object",
    },
    {
      code: " }",
      klass: "code-object",
    },
    {
      code: ")",
      klass: "code-bracket",
    },
    {
      code: ";",
      klass: "code-white",
    },
  ],
  [
    {
      code: "}",
      klass: "code-object",
    },
  ],
];
const ul = document.querySelector(".content");

const init = () => {
  for (let i = 0; i < code.length; i++) {
    const pre = document.createElement("pre");
    ul.appendChild(pre);

    for (let j = 0; j < code[i].length; j++) {
      console.log("hola");
      const span = document.createElement("span");
      const { code: text, klass, link } = code[i][j] ?? {};
      span.className = klass ? klass : "";
      span.innerHTML = text ? text : "";
      if (link) {
        span.setAttribute("href", code[i][j].link);
        span.setAttribute("target", "_blank");
      }
      pre.appendChild(span);
    }
  }
};

const animation = async () => {
  const lines = [...ul.children];
  lines.forEach((line) => {
    [...line.children].forEach((word) => {
      word.innerText = "";
      [...word.classList].includes("opacity-0")
        ? word.classList.remove("opacity-0")
        : null;
    });
  });

  let i = 0;

  for await (const line of lines) {
    i++;

    await new Promise(async (resolve) => {
      let j = 0;
      for await (const word of line.children) {
        j++;
        await new Promise(async (resolve) => {
          let finalWord = code[i - 1][j - 1].code;
          let currentWord = "";

          await new Promise((resolve) => {
            const id = setInterval(() => {
              if (currentWord.length === finalWord.length) {
                if ([...word.classList].includes("border-r")) {
                  word.classList.remove("border-white");
                  word.classList.remove("border-r");
                }
                resolve(true);
                clearInterval(id);
              } else {
                if (![...word.classList].includes("border-r")) {
                  word.classList.add("border-r");
                  word.classList.add("border-white");
                }
                currentWord += finalWord[currentWord.length];
                word.innerText = currentWord;
              }
            }, 15);
          });

          resolve(true);
        });
        continue;
      }

      resolve(true);
    });

    continue;
  }

  localStorage.setItem("code-animation", "false");
  return Promise.resolve(true);
};

init();
animation();
